    
# 1.Mac中使用Vagrant配置虚拟机


    Vagrant.configure("2") do |config|
      config.vm.box = "centos/7"
      config.vm.network "public_network", auto_config: false, bridge: "en1: Wi-Fi (AirPort)"
      #创建虚拟机执行的命令
      config.vm.provision "shell", inline: <<-SHELL
        yum install -y net-tools wget 
        echo "192.168.31.185 soft.home" >> /etc/hosts
        mkdir /root/soft
        wget -O /root/soft/jdk-8u144-linux-x64.rpm http://soft.home/jdk-8u144-linux-x64.rpm
        rpm -ivh /root/soft/jdk-8u144-linux-x64.rpm
        setenforce 0 
        sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config
        /bin/systemctl restart  sshd.service
        echo "RSAAuthentication yes" >>/etc/ssh/sshd_config
        echo "PubkeyAuthentication yes" >>/etc/ssh/sshd_config
        mkdir -p /root/.ssh
        touch /root/.ssh/authorized_keys
        chmod 600 /root/.ssh/authorized_keys
        ssh-keygen -t rsa -P "" -f /root/.ssh/id_rsa
        cat /root/.ssh/id_rsa.pub >> /root/.ssh/authorized_keys
      SHELL
    
      config.vm.define "hadoop_master" do |hadoop_master|
        #配置网卡
        hadoop_master.vm.provision "shell",
          run: "always",
          inline: "ifconfig eth1 192.168.31.130 netmask 255.255.255.0 up"
      end
      config.vm.define "hadoop_node1" do |hadoop_node1|
        #配置网卡
        hadoop_node1.vm.provision "shell",
          run: "always",
          inline: "ifconfig eth1 192.168.31.131 netmask 255.255.255.0 up"
      end
      config.vm.define "hadoop_node2" do |hadoop_node2|
        #配置网卡
        hadoop_node2.vm.provision "shell",
          run: "always",
          inline: "ifconfig eth1 192.168.31.132 netmask 255.255.255.0 up"
      end
    end



# 2.创建一个软件下载的服务

## 2.1 安装nginx
    brew install nginx
## 2.2 配置nginx
    server {
        server_name soft.home;
        listen 80;
        access_log  /usr/local/var/log/nginx/proxy_access.log;
        error_log   /usr/local/var/log/nginx/proxy_error.log;
        root /Users/chengtao/cloud/vagrant/soft;
    }    
    

